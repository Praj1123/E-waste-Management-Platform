<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Razorpay Payment</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Pay with Razorpay</h1>
    <button id="pay-button">Pay Now</button>
    <form id="payment-form" action="/payment/success" method="POST">
        <input type="hidden" name="razorpay_payment_id" id="razorpay_payment_id">
        <input type="hidden" name="razorpay_order_id" id="razorpay_order_id">
        <input type="hidden" name="razorpay_signature" id="razorpay_signature">
    </form>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <script>
        $(document).ready(function(){
            $('#pay-button').click(function(e){
                e.preventDefault();
                // Create a new order from the backend
                $.post('/create_order', function(order) {
                    var options = {
                        "key": "rzp_test_l57LNe7mJd4jWC", // Your Razorpay API Key
                        "amount": order.amount, // Amount in paise
                        "currency": "INR",
                        "name": "Your Company Name",
                        "description": "Purchase Description",
                        "image": "https://yourlogo.com/logo.png",
                        "order_id": order.id, // Order ID created in backend
                        "handler": function (response){
                            // Handler to capture the payment
                            $('#razorpay_payment_id').val(response.razorpay_payment_id);
                            $('#razorpay_order_id').val(response.razorpay_order_id);
                            $('#razorpay_signature').val(response.razorpay_signature);

                            // Submit the form to the backend
                            $('#payment-form').submit();
                        },
                        "prefill": {
                            "name": "Customer Name",
                            "email": "customer@example.com"
                        },
                        "theme": {
                            "color": "#F37254"
                        }
                    };
                    var rzp = new Razorpay(options);
                    rzp.open();
                });
            });
        });
    </script>
</body>
</html>
